{"version":3,"file":"js/173.b518bcb4.js","mappings":"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","sources":["webpack://week7-hw-dashboard/./src/views/UserCart.vue","webpack://week7-hw-dashboard/./src/views/UserCart.vue?698a"],"sourcesContent":["<template>\n  <div class=\"container\">\n    <VueLoading :active=\"isLoading\"></VueLoading>\n    <div class=\"text-end\">\n      <button\n        class=\"btn btn-outline-danger\"\n        type=\"button\"\n        @click=\"deleteAllCartItem\"\n        :disabled=\"cartData.carts.length === 0\"\n      >\n        清空購物車\n      </button>\n    </div>\n    <table class=\"table align-middle\">\n      <thead>\n        <tr>\n          <th></th>\n          <th>品名</th>\n          <th style=\"width: 150px\">數量/單位</th>\n          <th>價格</th>\n        </tr>\n      </thead>\n      <tbody>\n        <!-- 加入 v-if -->\n        <template v-if=\"cartData.carts\">\n          <tr v-for=\"item in cartData.carts\" :key=\"item.id\">\n            <td>\n              <!-- 刪除特定購物車產品按鈕 -->\n              <button\n                type=\"button\"\n                class=\"btn btn-outline-danger btn-sm\"\n                :disabled=\"loadingState === item.id\"\n                @click=\"removeCartItem(item.id)\"\n              >\n                x\n              </button>\n            </td>\n            <td>\n              {{ item.product.title }}\n              <div class=\"text-success\" v-if=\"item.coupon\">已套用優惠券</div>\n            </td>\n            <td>\n              <div class=\"input-group input-group-sm\">\n                <div class=\"input-group mb-3\">\n                  <input\n                    min=\"1\"\n                    type=\"number\"\n                    class=\"form-control\"\n                    v-model.number=\"item.qty\"\n                    :disabled=\"loadingState === item.id\"\n                    @change=\"updateCartNumber(item)\"\n                  />\n\n                  <span class=\"input-group-text\" id=\"basic-addon2\">{{\n                    item.product.unit\n                  }}</span>\n                </div>\n              </div>\n            </td>\n            <td class=\"text-end\">\n              <small class=\"text-success\" v-if=\"item.final_total !== item.total\"\n                >折扣價：</small\n              >\n              {{ item.total }}\n            </td>\n          </tr>\n        </template>\n      </tbody>\n      <tfoot>\n        <tr>\n          <td colspan=\"3\" class=\"text-end\">總計</td>\n          <td class=\"text-end\">{{ cartData.total }}</td>\n        </tr>\n        <tr v-if=\"cartData.final_total !== cartData.total\">\n          <td colspan=\"3\" class=\"text-end text-success\">折扣價</td>\n          <td class=\"text-end text-success\">\n            {{ cartData.total - cartData.final_total }}\n          </td>\n        </tr>\n      </tfoot>\n    </table>\n\n    <div class=\"input-group mb-3 input-group-sm\">\n      <input\n        type=\"text\"\n        class=\"form-control\"\n        v-model=\"discountCode\"\n        placeholder=\"請輸入優惠碼\"\n      />\n      <div class=\"input-group-append\">\n        <button\n          class=\"btn btn-outline-secondary\"\n          type=\"button\"\n          @click=\"addCoupon\"\n        >\n          套用優惠碼\n        </button>\n      </div>\n    </div>\n\n    <div class=\"text-end\" v-if=\"cartData.carts.length !== 0\">\n      <router-link type=\"button\" class=\"btn btn-lg btn-primary\" to=\"/user/order\"\n        >結帳去</router-link\n      >\n    </div>\n  </div>\n</template>\n\n<script>\nimport emitter from \"@/libraries/emitter\";\nexport default {\n  data() {\n    return {\n      cartData: {\n        carts: [],\n      },\n      discountCode: \"\",\n      loadingState: \"\",\n      isLoading: false,\n    };\n  },\n  methods: {\n    // 取得購物車列表資訊\n    getCartList() {\n      this.isLoading = true;\n      const url = `${process.env.VUE_APP_API}/api/${process.env.VUE_APP_PATH}/cart`;\n      this.$http\n        .get(url)\n        .then((res) => {\n          console.log(res);\n          this.cartData = res.data.data;\n          console.log(this.cartData);\n          this.isLoading = false;\n        })\n        .catch((err) => {\n          console.log(err.response.data);\n        });\n    },\n    //更改購物車數量\n    updateCartNumber(item) {\n      // 判斷是否為 0 或是負數\n      if (item.qty == 0 || item.qty < 0) {\n        alert(\"數量至少為1個\");\n        this.getCartList();\n        return;\n      }\n      // 賦予 disabled 狀態\n      this.loadingState = item.id;\n      const data = {\n        product_id: item.id,\n        qty: item.qty,\n      };\n\n      const url = `${process.env.VUE_APP_API}/api/${process.env.VUE_APP_PATH}/cart/${item.id}`;\n      this.$http\n        .put(url, { data })\n        .then((res) => {\n          console.log(res);\n          // 再取得購物車列表\n          this.getCartList();\n          this.loadingState = \"\";\n          emitter.emit(\"get-cart\");\n        })\n        .catch((err) => {\n          console.log(err.response.data);\n        });\n    },\n\n    // 刪除購物車特定產品\n    removeCartItem(id) {\n      // 賦予 disabled 狀態\n      this.loadingState = id;\n      const url = `${process.env.VUE_APP_API}/api/${process.env.VUE_APP_PATH}/cart/${id}`;\n      this.$http\n        .delete(url)\n        .then(() => {\n          // console.log(res);\n          // 再取得購物車列表\n          this.getCartList();\n          this.loadingState = \"\";\n          emitter.emit(\"get-cart\");\n        })\n        .catch((err) => {\n          console.log(err.response.data);\n        });\n    },\n    //清空全部購物車產品\n    deleteAllCartItem() {\n      this.isLoading = true;\n      const url = `${process.env.VUE_APP_API}/api/${process.env.VUE_APP_PATH}/carts`;\n      this.$http\n        .delete(url)\n        .then(() => {\n          // console.log(res);\n          // 再取得購物車列表\n          this.getCartList();\n          emitter.emit(\"get-cart\");\n          this.isLoading = false;\n        })\n        .catch((err) => {\n          console.log(err.response.data);\n        });\n    },\n\n    //加入優惠券\n    addCoupon() {\n      this.isLoading = true;\n      const url = `${process.env.VUE_APP_API}/api/${process.env.VUE_APP_PATH}/coupon`;\n      const couponCode = {\n        code: this.discountCode,\n      };\n      this.$http\n        .post(url, { data: couponCode })\n        .then(() => {\n          this.getCartList();\n          this.isLoading = false;\n        })\n        .catch(() => {\n          this.isLoading = false;\n          alert(\"折扣碼失效\");\n        });\n    },\n  },\n\n  mounted() {\n    this.getCartList();\n  },\n};\n</script>\n","import { render } from \"./UserCart.vue?vue&type=template&id=1ba46c6a\"\nimport script from \"./UserCart.vue?vue&type=script&lang=js\"\nexport * from \"./UserCart.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"C:\\\\Users\\\\Steven\\\\Desktop\\\\2022_VueTaskWeek7\\\\week7-hw-dashboard\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"names":["class","_createElementVNode","style","id","colspan","_createElementBlock","_createVNode","_component_VueLoading","active","$data","type","onClick","$options","disabled","carts","length","_hoisted_3","_hoisted_5","_Fragment","key","_renderList","item","_hoisted_6","product","title","coupon","min","qty","$event","onChange","_toDisplayString","unit","final_total","total","_hoisted_14","_hoisted_16","_hoisted_17","placeholder","_component_router_link","to","data","cartData","discountCode","loadingState","isLoading","methods","getCartList","this","url","$http","get","then","res","console","log","catch","err","response","updateCartNumber","alert","product_id","put","emitter","removeCartItem","delete","deleteAllCartItem","addCoupon","couponCode","code","post","mounted","__exports__","render"],"sourceRoot":""}